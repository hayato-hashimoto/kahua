;;
;; Kahua client interface for Emacs
;;
;;  Copyright (c) 2003 Scheme Arts, L.L.C., All rights reserved.
;;  Copyright (c) 2003 Time Intermedia Corporation, All rights reserved.
;;
;; $Id: kahua.el.in,v 1.5 2006/05/13 01:55:35 bizenn Exp $
;;

(require 'cmuscheme)
(require 'kahua-shell)

;; Custom Variables:
(defgroup kahua nil
  "*Support for editing and running remote kahua server application."
  :group 'scheme
  :prefix "kahua-"
  :link '(url-link "http://www.kahua.org/"))

(defcustom kahua-ssh-mode t
  "*If non nil, run kahua-shell via ssh."
  :type 'boolean
  :group 'kahua)

(defcustom kahua-admin-command "##bindir##/kahua-admin"
  "*Kahua-admin command file(full path or base name)."
  :type 'string
  :group 'kahua)

(defcustom kahua-shell-command "##bindir##/kahua-shell"
  "*Kahua-shell command file(full path or base name)."
  :type 'string
  :group 'kahua)

(defcustom kahua-ssh-opts '("-t")
  "*Options for ssh which run kahua-shell."
  :type '(repeat string)
  :group 'kahua)

(defcustom kahua-default-server ""
  "*Default kahua server."
  :type 'string
  :group 'kahua)

(defcustom kahua-default-user (or (getenv "USER")
				  (getenv "LOGNAME")
				  (user-login-name))
  "*Default username for running kahua server."
  :type 'string
  :group 'kahua)

(defcustom kahua-user-mode ""
  "*User name for kahua-shell. If empty, run kahua-shell without -user option."
  :type 'string
  :group 'kahua)

(defcustom kahua-admin-coding-system 'utf-8
  "*Kahua-admin coding system."
  :type 'symbol
  :group 'kahua)
(defun get-kahua-admin-coding-system (p) nil kahua-admin-coding-system)

(defcustom kahua-shell-coding-system 'utf-8
  "*Kahua-shell coding system."
  :type 'symbol
  :group 'kahua)
(defun get-kahua-shell-coding-system (p) nil kahua-shell-coding-system)

(setq process-coding-system-alist
      (append '(("kahua-admin" . get-kahua-admin-coding-system)
		("kahua-shell" . get-kahua-shell-coding-system))
	      process-coding-system-alist))

(defun run-kahua ()
  "Run kahua Emacs interface in *scheme* buffer.  Make sure you're not running other inferior scheme."
  (interactive)
  (run-scheme kahua-admin-command))

(provide 'kahua)

;; Local variables:
;; mode: emacs-lisp
;; end:



